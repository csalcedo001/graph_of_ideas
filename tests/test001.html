<!DOCTYPE html>
<html>
	<head>
		<title>Idea graph</title>
	</head>

	<body>
		<h1>Hello world!</h1>
		<canvas id=board width=600px height=400px style="border:1px solid #000000;">
	</body>

	<script>
		var canvas = document.getElementById("board");
		var ctx = canvas.getContext("2d");

		// Circles indexed by id
		var circleMap = {};

		// CircleIDCount
		var circleCount = 0;

		// Classes

		const Circle = class {
			constructor(x, y, r) {
				this.id = circleMap[circleCount] = circleCount;
				circleCount++;

				this.move(x, y);
				this.r = r;
				this.color = "#FFFFFF";

				this.text = "";
			}

			draw() {
				ctx.fillStyle = this.color;
				ctx.beginPath();
				ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);
				ctx.stroke();
				ctx.fill();
			}

			move(x, y) {
				this.x = x;
				this.y = y;
			}

			contains(x, y) {
				return Math.sqrt(
					(x - this.x) * (x - this.x) +
					(y - this.y) * (y - this.y)
				) <= this.r;
			}

			paint(color) {
				this.color = color;
			}
		}
		
		// Variables / Data

		// Canvas dimensions
		var height = canvas.getAttribute("height");
		var width = canvas.getAttribute("width");

		
		var value = 1;
		var count = 0;
		var circles = [];
		var followCircle = new Circle(0, 0, 20);

		for (var i = 0; i < 10; i++) {
			circles.push(new Circle(10 * i, 5 * i, 40));
		}

		function getMousePosition(evt) {
			var rect = canvas.getBoundingClientRect();

			return {
				x: evt.clientX - rect.left,
				y: evt.clientY - rect.top
			};
		}

		canvas.addEventListener("mousedown", function(evt) {
			var mouse = getMousePosition(evt);

			for (var i = 9; i >= 0; i--) {
				if (circles[i].contains(mouse.x, mouse.y)) {
					circles[i].paint("red");
					return;
				}
			}
		}, false);

		// Functions

		function draw() {
			ctx.clearRect(0, 0, 900, 900);

			for (var i = 0; i < 10; i++) {
				circles[i].x += value;
				
				// if (circles[i].contains(110, 50)) {
				// 	circles[i].paint("red");
				// } else {
				// 	circles[i].paint("white");
				// }

				circles[i].draw();
			}

			followCircle.draw();

			if (count >= 100) value = -1;
			if (count <= 0) value = 1;

			count += value;
		}

		setInterval(draw, 10);
	</script>
</html>
