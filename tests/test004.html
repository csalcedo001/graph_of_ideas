<!DOCTYPE html>
<html>
	<head>
		<title>Idea graph</title>
	</head>

	<body>
		<h1>Ideas...</h1>
		<canvas id=board style="width=100%; height=100%; margin=0; border:1px solid #000000;">
	</body>

	<script>
		var canvas = document.getElementById("board");
		var ctx = canvas.getContext("2d");

		ctx.canvas.width = window.innerWidth;
		ctx.canvas.height = window.innerHeight;

		// Circle id count
		var objectCount = 0;

		// Objects indexed by id
		var objectMap = {};

		// Classes

		const Circle = class {
			constructor(x, y, r) {
				// Object unique ID
				this.id = objectCount;
				objectCount++;

				// Add object to global object mapping
				objectMap[this.id] = this;
				
				// Object positioning and color
				this.move(x, y);
				this.r = r;
				this.color = "#FFFFFF";

				// Text to be displayed in object
				this.text = "";

				// Array of indices
				this.outNeighbors = {};
				this.selfNeighbor = false; // For multigraphs, represent by number
			}

			draw() {
				// Draw the circle
				ctx.fillStyle = this.color;
				ctx.beginPath();
				ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);
				ctx.stroke();
				ctx.fill();

				// Print text inside circle
				ctx.fillStyle = "black";
				ctx.font = "10px Arial";
				ctx.fillText(this.text, this.x, this.y);
			}

			move(x, y) {
				this.x = x;
				this.y = y;
			}

			// Test whether the object contains point (x, y)
			contains(x, y) {
				return Math.sqrt(
					(x - this.x) * (x - this.x) +
					(y - this.y) * (y - this.y)
				) <= this.r;
			}

			// Update color
			paint(color) {
				this.color = color;
			}

			// Update text
			say(text) {
				this.text = text;
			}

			connect(id) {
				if (id == this.id) {
					this.selfNeighbor = true;
				} else {
					this.outNeighbors[id] = objectMap[id];
				}
			}
		}

		// Initial circle
		var originObject = new Circle(400, 400, 50);
		
		delete objectMap[objectCount - 1];
		originObject.outNeighbors = objectMap;

		var currentObject = originObject;
		var selectedObjectID = originObject.id;

		for (var i = 0; i < 10; i++) {
			var newObject = new Circle(15 * i, 10 * i, 40);
			newObject.say(newObject.id.toString());
		}


		
		var console = new Circle(250, 250, 40);

		function draw() {
			ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
			
			console.paint("red");
			console.say(selectedObjectID.toString());
			console.draw();

			for (key in currentObject.outNeighbors) {
				objectMap[key].draw();
			}
		}

		setInterval(draw, 10);
	</script>
</html>
